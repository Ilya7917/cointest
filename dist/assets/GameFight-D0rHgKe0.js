import{u as P,j as C,k as v,d as I,r as i,o as $,K as A,b as D,c as F,e as r,y as T,L as G,n as j,x as E,A as M,B as W,_ as z}from"./index-CBVpKYb7.js";const g=P(),L=C("games",{state:()=>({gamesScore:null}),getters:{},actions:{async setUserHP(s){const a=await v.post("https://taptaptap.testcoin.uk/setMatchHP",{hp:s},{headers:{"x-api-key":g.getAccessToken}});return console.log(a),!!a.data.sucess},async getGamesScore(){const s=await v.get("https://taptaptap.testcoin.uk/gamesLeaderBoard",{headers:{"x-api-key":g.getAccessToken}});return console.log(s),this.gamesScore=s.data,s.data},async setUserScore(s,a,p){const u=await v.post("https://taptaptap.testcoin.uk/setUserScore",{isWin:s,enemyID:a,enemyHealth:p},{headers:{"x-api-key":g.getAccessToken}});return console.log(u),!!u.data.sucess},async updateUserHealthDefens(s){const a=await v.post("https://taptaptap.testcoin.uk/setDefensHP",{hp:s},{headers:{"x-api-key":g.getAccessToken}});return console.log(a),!!a.data.sucess}}}),f=s=>(M("data-v-28e8432d"),s=s(),W(),s),O=["width","height"],V={id:"unity-loading-bar"},J=f(()=>r("div",{id:"unity-logo"},null,-1)),K={id:"unity-progress-bar-empty"},Q=f(()=>r("div",{id:"unity-webgl-logo"},null,-1)),q=f(()=>r("div",{id:"unity-build-title"},"FlappyDick",-1)),y="/BuildFight",R=I({__name:"GameFight",setup(s){const a=L(),p=P(),u=i("unity-desktop"),w=i(960),_=i(600),S=i("0%"),h=i(!0),k=i(0),b=i(null),c=i(null),d=i(null),U=`${y}/buildes.loader.js`,H={dataUrl:`${y}/buildes.data`,frameworkUrl:`${y}/buildes.framework.js`,codeUrl:`${y}/buildes.wasm`,streamingAssetsUrl:"StreamingAssets",companyName:"DefaultCompany",productName:"FlappyDick",productVersion:"0.1",showBanner:(t,o)=>{if(d.value){const e=document.createElement("div");e.innerHTML=t,d.value.appendChild(e),o==="error"?e.style.background="red":o==="warning"&&(e.style.background="yellow"),e.style.padding="10px",setTimeout(()=>{d.value&&d.value.removeChild(e)},5e3)}}},B=t=>{S.value=`${100*t}%`,t==1&&console.log("load Finish")},N=()=>{var t;(t=c.value)==null||t.SetFullscreen(1)};$(async()=>{var o,e;if(((o=p.user)==null?void 0:o.id)!=null&&(k.value=(e=p.user)==null?void 0:e.id),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){const n=document.createElement("meta");n.name="viewport",n.content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes",document.getElementsByTagName("head")[0].appendChild(n),u.value="unity-mobile",w.value=window.innerWidth,_.value=window.innerHeight}h.value=!0;const t=document.createElement("script");t.src=U,t.onload=async()=>{try{c.value=await createUnityInstance(b.value,H,B),h.value=!1}catch(n){alert(n)}},document.body.appendChild(t)}),A(()=>{c.value&&c.value.Quit().then(()=>{c.value=null})});const l=i({userHP:0,userName:"",enemyHP:0,enemyName:""}),m=i(0);return window.SetPlayerHP=function(t){console.log(t),a.setUserHP(t).then(o=>{l.value.userHP=t,o&&a.getGamesScore().then(e=>{if(l.value.userName="Bazil",console.log(e),e!=null&&e.length>0){let n=e.findIndex(x=>x.ID==k.value);n==0||n==-1?(l.value.enemyHP=100,l.value.enemyName="Computer",m.value=-1):(l.value.enemyHP=100,l.value.enemyName=e[n-1].UserName,m.value=e[n-1].UserID)}else l.value.enemyHP=100,l.value.enemyName="Computer",m.value=-1;c.value.SendMessage("LoadCanvas","OnHPWasSet",JSON.stringify(l.value))})})},window.SetWinner=function(t){const[o,e]=t.split(",");console.log(o,e),a.setUserScore(o=="Player1",m.value,Number(e)).then(n=>{console.log(n)})},(t,o)=>(D(),F("div",{id:"unity-container",class:E(u.value)},[r("canvas",{id:"unity-canvas",ref_key:"canvas",ref:b,width:w.value,height:_.value,tabindex:"-1"},null,8,O),T(r("div",V,[J,r("div",K,[r("div",{id:"unity-progress-bar-full",style:j({width:S.value})},null,4)])],512),[[G,h.value]]),r("div",{id:"unity-warning",ref_key:"warningBanner",ref:d},null,512),r("div",{id:"unity-footer"},[Q,r("div",{id:"unity-fullscreen-button",onClick:N}),q])],2))}}),X=z(R,[["__scopeId","data-v-28e8432d"]]),Z=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{X as G,Z as a,L as u};
