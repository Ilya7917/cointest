import{u as P,j as I,k as y,d as $,r as i,o as x,K as A,A as D,b as j,c as F,e as r,C as T,L as G,n as z,v as E,y as M,z as W,_ as L}from"./index-EneYuYxJ.js";const g=P(),O=I("games",{state:()=>({gamesScore:null}),getters:{},actions:{async setUserHP(s){const a=await y.post("https://taptaptap.testcoin.uk/setMatchHP",{hp:s},{headers:{"x-api-key":g.getAccessToken}});return console.log(a),!!a.data.sucess},async getGamesScore(){const s=await y.get("https://taptaptap.testcoin.uk/gamesLeaderBoard",{headers:{"x-api-key":g.getAccessToken}});return console.log(s),this.gamesScore=s.data,s.data},async setUserScore(s,a,c){const d=await y.post("https://taptaptap.testcoin.uk/setUserScore",{isWin:s,enemyID:a,enemyHealth:c},{headers:{"x-api-key":g.getAccessToken}});return console.log(d),!!d.data.sucess},async updateUserHealthDefens(s){const a=await y.post("https://taptaptap.testcoin.uk/setDefensHP",{hp:s},{headers:{"x-api-key":g.getAccessToken}});return console.log(a),!!a.data.sucess}}}),f=s=>(M("data-v-69b60bc1"),s=s(),W(),s),V=["width","height"],J={id:"unity-loading-bar"},K=f(()=>r("div",{id:"unity-logo"},null,-1)),Q={id:"unity-progress-bar-empty"},q=f(()=>r("div",{id:"unity-webgl-logo"},null,-1)),R=f(()=>r("div",{id:"unity-build-title"},"FlappyDick",-1)),X=$({__name:"GameFight",setup(s){const a=O(),c=P(),d=i("unity-desktop"),w=i(960),_=i(600),b=i("0%"),h=i(!0),k=i(0),S=i(null),u=i(null),p=i(null),v="https://taptaptap.testcoin.uk/uploads/BuildBirds",U=`${v}/buildes.loader.js`,H={dataUrl:`${v}/buildes.data`,frameworkUrl:`${v}/buildes.framework.js`,codeUrl:`${v}/buildes.wasm`,streamingAssetsUrl:`${v}/UnityServicesProjectConfiguration.json`,companyName:"DefaultCompany",productName:"FlappyDick",productVersion:"0.1",showBanner:(e,o)=>{if(p.value){const t=document.createElement("div");t.innerHTML=e,p.value.appendChild(t),o==="error"?t.style.background="red":o==="warning"&&(t.style.background="yellow"),t.style.padding="10px",setTimeout(()=>{p.value&&p.value.removeChild(t)},5e3)}}},B=e=>{b.value=`${100*e}%`,e==1&&console.log("load Finish")},C=()=>{var e;(e=u.value)==null||e.SetFullscreen(1)};x(async()=>{var o,t;if(((o=c.user)==null?void 0:o.id)!=null&&(k.value=(t=c.user)==null?void 0:t.id),/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)){const n=document.createElement("meta");n.name="viewport",n.content="width=device-width, height=device-height, initial-scale=1.0, user-scalable=no, shrink-to-fit=yes",document.getElementsByTagName("head")[0].appendChild(n),d.value="unity-mobile",w.value=window.innerWidth,_.value=window.innerHeight}h.value=!0;const e=document.createElement("script");e.src=U,e.onload=async()=>{try{u.value=await createUnityInstance(S.value,H,B),h.value=!1}catch(n){alert(n)}},document.body.appendChild(e)}),A(()=>{u.value&&u.value.Quit().then(()=>{u.value=null})});const l=i({userHP:0,userName:"",enemyHP:0,enemyName:""}),m=i(0);return window.SetPlayerHP=function(e){if(c.user){if(console.log(e),c.user.balance<e){D().showAlert("Недостаточный баланс");return}a.setUserHP(e).then(o=>{c.user&&(c.user.balance-=e,l.value.userHP=e,o&&a.getGamesScore().then(t=>{if(l.value.userName="Bazil",console.log(t),t!=null&&t.length>0){let n=t.findIndex(N=>N.ID==k.value);n==0||n==-1?(l.value.enemyHP=100,l.value.enemyName="Computer",m.value=-1):(l.value.enemyHP=100,l.value.enemyName=t[n-1].UserName,m.value=t[n-1].UserID)}else l.value.enemyHP=100,l.value.enemyName="Computer",m.value=-1;u.value.SendMessage("LoadCanvas","OnHPWasSet",JSON.stringify(l.value))}))})}},window.SetWinner=function(e){const[o,t]=e.split(",");console.log(o,t),a.setUserScore(o=="Player1",m.value,Number(t)).then(n=>{console.log(n)})},(e,o)=>(j(),F("div",{id:"unity-container",class:E(d.value)},[r("canvas",{id:"unity-canvas",ref_key:"canvas",ref:S,width:w.value,height:_.value,tabindex:"-1"},null,8,V),T(r("div",J,[K,r("div",Q,[r("div",{id:"unity-progress-bar-full",style:z({width:b.value})},null,4)])],512),[[G,h.value]]),r("div",{id:"unity-warning",ref_key:"warningBanner",ref:p},null,512),r("div",{id:"unity-footer"},[q,r("div",{id:"unity-fullscreen-button",onClick:C}),R])],2))}}),Y=L(X,[["__scopeId","data-v-69b60bc1"]]),ee=Object.freeze(Object.defineProperty({__proto__:null,default:Y},Symbol.toStringTag,{value:"Module"}));export{Y as G,ee as a,O as u};
